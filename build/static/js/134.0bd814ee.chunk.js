"use strict";(self.webpackChunkdatta_able_rv18_0_4=self.webpackChunkdatta_able_rv18_0_4||[]).push([[134],{10134:(e,t,s)=>{s.r(t),s.d(t,{Employee:()=>D,default:()=>C});var a=s(72791),i=s(74387),o=s(17451),n=s(68962),l=s.n(n),r=s(89139),d=s(43360),h=s(45085),c=s(50649),m=s.n(c),u=s(80184);class p extends a.Component{constructor(e){super(e),this.onSelectionChanged=e=>{this.setState({SelectID:e.selectedRowsData[0].Id})},this.onSelectClick=e=>{this.props.OnHide(this.state.SelectID)},this.onCloseClick=e=>{this.props.OnHide(0)},this.state={SelectID:0,jList:[]}}componentDidMount(){console.log("User",this.props.UserList)}render(){return(0,u.jsx)(a.Fragment,{children:(0,u.jsxs)(h.Z,{size:"xl",show:this.props.Show,onHide:this.onCloseClick,backdrop:"static",keyboard:!1,children:[(0,u.jsx)(h.Z.Header,{closeButton:!0,children:(0,u.jsx)(h.Z.Title,{children:"List of User"})}),(0,u.jsxs)(h.Z.Body,{children:[(0,u.jsxs)(m(),{id:"grid-list",dataSource:this.props.UserList,keyExpr:"Id",showBorders:!0,wordWrapEnabled:!0,allowSearch:!0,selection:{mode:"single"},hoverStateEnabled:!0,onSelectionChanged:this.onSelectionChanged,children:[(0,u.jsx)(c.SearchPanel,{visible:!0}),(0,u.jsx)(c.GroupPanel,{visible:!0}),(0,u.jsx)(c.Paging,{defaultPageSize:20}),(0,u.jsx)(c.Column,{dataField:"Id",visible:!1}),(0,u.jsx)(c.Column,{dataField:"UserName"}),(0,u.jsx)(c.Column,{dataField:"FullName"}),(0,u.jsx)(c.Column,{dataField:"Designation"}),(0,u.jsx)(c.Column,{dataField:"ContactNo"}),(0,u.jsx)(c.Column,{dataField:"Remark"})]}),(0,u.jsx)("br",{}),(0,u.jsx)("br",{}),(0,u.jsx)(d.Z,{variant:"secondary",onClick:this.onSelectClick,children:"Open"}),(0,u.jsx)(d.Z,{variant:"secondary",onClick:this.onCloseClick,icon:"feather icon-layers",children:"Close"})]})]})})}}const g=p;s(67810);var j=s(21830),x=s.n(j),y=s(55294),I=s(65410),E=s.n(I),R=(s(51793),s(47885)),S=s(85797);class D extends a.Component{constructor(e){super(e),this.componentDidMount=e=>{y.Z.all([y.Z.get("http://20.201.121.161:4478/api/Role",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),y.Z.get("http://20.201.121.161:4478/api/Branch",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}})]).then(y.Z.spread(((e,t)=>{console.log("jRoles",e),this.setState({jRoles:e.data,jBranch:t.data},(()=>console.log("jRoles",this.state.jRoles)))}))).catch((e=>console.log(e)))},this.onLoadPanelHiding=(e,t)=>{this.setState({LoadPanelVisible:!1}),this.OnNotification(e,t)},this.OnNotification=(e,t)=>{E()({message:e,type:t,displayTime:3e3,position:{at:"top right",offset:"50"}})},this.OnClickEvent=()=>{},this.OnSaveValidation=async()=>!0,this.SaveData=async e=>{await this.OnSaveValidation()&&x().fire({type:"info",showCancelButton:!0,text:"Do you want to save ?",confirmButtonText:"Yes",cancelButtonText:"No",allowOutsideClick:!1,allowEscapeKey:!1}).then((e=>{e.value?(this.setState({LoadPanelVisible:!0}),console.log({firstName:this.state.jEmployee.firstName,lastName:this.state.jEmployee.lastName,email:this.state.jEmployee.email,nic:this.state.jEmployee.nic,address:this.state.jEmployee.address,mobileNo:this.state.jEmployee.mobileNo,dob:this.state.jEmployee.dob,gender:this.state.jEmployee.gender,status:this.state.jEmployee.status,type:0,roleId:this.state.jEmployee.roleId,branchId:2,designation:this.state.jEmployee.designation,changePassword:!1}),this.serverRequest=y.Z.post("http://20.201.121.161:4478/api/Employee",{firstName:this.state.jEmployee.firstName,lastName:this.state.jEmployee.lastName,email:this.state.jEmployee.email,nic:this.state.jEmployee.nic,address:this.state.jEmployee.address,mobileNo:JSON.stringify(this.state.jEmployee.mobileNo),dob:this.state.jEmployee.dob,gender:this.state.jEmployee.gender,status:this.state.jEmployee.status,type:0,roleId:this.state.jEmployee.roleId,branchId:2,designation:this.state.jEmployee.designation,changePassword:!1},{headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"}}).then((e=>{this.onLoadPanelHiding(e.data.email,"success"),this.OnClearForm()})).catch((e=>{this.onLoadPanelHiding("Something went wrong","error"),console.log("Error",e)}))):"cancel"==e.dismiss||e.dismiss}))},this.OnClearForm=()=>{console.log("cleared");this.state.jAuthorization;this.setState({EmployeeID:0,jEmployee:{Status:"Active"},jRoles:[],jAuthorization:[],jEmployeeList:[],ListViewing:!1,DataLoading:!1,PasswordChange:!1,IsCashier:!1,DocReadOnly:!1})},this.onValueChanged=e=>{this.state.SelectedSchool=[];e.value.forEach((e=>{this.state.SelectedSchool.push({Id:e})})),console.log(this.state.SelectedSchool)},this.OnListClickEvent=e=>{this.setState({ListViewing:!this.state.ListViewing},(()=>{this.state.ListViewing&&(this.serverRequest=y.Z.get("/api/user-lookup").then((e=>{console.log(e.data),this.setState({jUserList:e.data})})).catch((e=>{console.log(e)}))),this.state.ListViewing||0==e||this.setState({UserID:e},(()=>this.OnLoadData()))}))},this.onRowUpdating=e=>{9===e.newData.Auth&&(e.cancel=!0)},this.onRowUpdated=e=>{let t=this.state.jAuthorization;if(1===e.data.Type)t=t.map((t=>t.RootParent===e.data.MenuID||t.ParentID===e.data.MenuID?{...t,Auth:e.data.Auth}:t));else{let s=t.filter((t=>t.ParentID===e.data.ParentID)),a=t.filter((t=>t.ParentID===e.data.ParentID&&t.Auth===e.data.Auth));t=s.length===a.length?t.map((t=>t.MenuID===e.data.ParentID?{...t,Auth:e.data.Auth}:t)):t.map((t=>t.MenuID===e.data.ParentID?{...t,Auth:9}:t));let i=t.filter((t=>t.RootParent===e.data.RootParent)),o=t.filter((t=>t.RootParent===e.data.RootParent&&t.Auth===e.data.Auth));t=i.length===o.length?t.map((t=>t.MenuID===e.data.RootParent?{...t,Auth:e.data.Auth}:t)):t.map((t=>t.MenuID===e.data.RootParent?{...t,Auth:9}:t))}this.setState({jAuthorization:t})},this.state={EmployeeID:0,jEmployee:{Status:"Active"},jRoles:[],jBranch:[],jAuthorization:[],jEmployeeList:[],ListViewing:!1,DataLoading:!1,PasswordChange:!1,IsCashier:!1,DocReadOnly:!1},this.Status=[{ID:"Active",Name:"Active"},{ID:"Inactive",Name:"Inactive"}],this.Gender=[{ID:"Male",Name:"Male"},{ID:"Female",Name:"Female"}],this.Institute=[{ID:0,Name:"Wildlife conservations"},{ID:1,Name:"Forest conservations"}],this.onLoadPanelHiding=this.onLoadPanelHiding.bind(this),this.FormRef=a.createRef()}get FormLayout(){return this.FormRef.current.instance}OnLoadData(){y.Z.all([y.Z.get("/api/user",{params:{UserID:this.state.UserID}})]).then(y.Z.spread((e=>{console.log("User",e),this.setState({DataLoading:!0},(()=>this.setState({jlUserGroup:this.getUserGroup(JSON.parse(e.data[0].Users).GroupID),jUser:JSON.parse(e.data[0].Users),jAuthorization:JSON.parse(e.data[0].UserWiseAuthontication),PasswordChange:!1})))}))).catch((e=>console.log(e)))}render(){return(0,u.jsxs)(i.Z,{children:[(0,u.jsx)(o.Z,{title:"Employee",children:(0,u.jsx)(l(),{ref:this.FormRef,formData:this.state.jEmployee,children:(0,u.jsxs)(n.GroupItem,{caption:"Employee Information",colCount:2,children:[(0,u.jsxs)(n.Item,{dataField:"firstName",editorOptions:{maxLength:50,readOnly:0!=this.state.EmployeeID},children:[(0,u.jsx)(n.RequiredRule,{message:"Field required"}),(0,u.jsx)(n.Label,{text:"First Name"})]}),(0,u.jsx)(n.Item,{dataField:"lastName",editorOptions:{maxLength:50},children:(0,u.jsx)(n.RequiredRule,{message:"Field required"})}),(0,u.jsxs)(n.Item,{dataField:"email",editorOptions:{maxLength:50},children:[(0,u.jsx)(n.RequiredRule,{message:"Field required"}),(0,u.jsx)(n.EmailRule,{message:"Email is invalid"})]}),(0,u.jsx)(n.Item,{dataField:"nic",editorOptions:{maxLength:12,minLength:10},children:(0,u.jsx)(n.RequiredRule,{message:"Field required"})}),(0,u.jsx)(n.Item,{dataField:"address",editorOptions:{maxLength:100},children:(0,u.jsx)(n.RequiredRule,{message:"Field required"})}),(0,u.jsx)(n.Item,{dataField:"mobileNo",editorType:"dxNumberBox",editorOptions:{maxLength:12},children:(0,u.jsx)(n.RequiredRule,{message:"Field required"})}),(0,u.jsxs)(n.Item,{dataField:"dob",editorType:"dxDateBox",children:[(0,u.jsx)(n.Label,{text:"Birthday"}),(0,u.jsx)(n.RequiredRule,{message:"Field required"})]}),(0,u.jsx)(n.Item,{dataField:"gender",editorType:"dxSelectBox",editorOptions:{items:this.Gender,searchEnabled:!0,displayExpr:"Name",valueExpr:"ID"},children:(0,u.jsx)(n.RequiredRule,{message:"Field required"})}),(0,u.jsxs)(n.Item,{dataField:"roleId",editorType:"dxSelectBox",editorOptions:{items:this.state.jRoles,searchEnabled:!0,displayExpr:"name",valueExpr:"id"},children:[(0,u.jsx)(n.Label,{text:"Job Role"}),(0,u.jsx)(n.RequiredRule,{message:"Field required"})]}),(0,u.jsxs)(n.Item,{dataField:"branchId",editorType:"dxSelectBox",editorOptions:{items:this.state.jBranch,searchEnabled:!0,displayExpr:"name",valueExpr:"id"},children:[(0,u.jsx)(n.Label,{text:"Branch"}),(0,u.jsx)(n.RequiredRule,{message:"Field required"})]}),(0,u.jsx)(n.Item,{dataField:"designation",editorOptions:{maxLength:100},children:(0,u.jsx)(n.RequiredRule,{message:"Field required"})}),(0,u.jsx)(n.Item,{dataField:"status",editorType:"dxSelectBox",editorOptions:{items:this.Status,searchEnabled:!0,displayExpr:"Name",valueExpr:"ID"},children:(0,u.jsx)(n.RequiredRule,{message:"Field required"})})]})})}),(0,u.jsxs)(r.Z,{bg:"light",variant:"light",children:[(0,u.jsx)(d.Z,{variant:"secondary",onClick:this.SaveData,disabled:this.state.DocReadOnly,children:"Save"}),(0,u.jsx)(d.Z,{variant:"secondary",onClick:this.OnClearForm,children:"Clear"}),(0,u.jsx)(d.Z,{variant:"secondary",onClick:this.OnListClickEvent,children:"View List"})]}),(0,u.jsx)(R.LoadPanel,{message:"Processing.... Please, wait...",shadingColor:"rgba(0,0,0,0.4)",onHiding:this.onLoadPanelHiding,visible:this.state.LoadPanelVisible,showIndicator:!0,shading:!0,showPane:!0,closeOnOutsideClick:!1,width:500}),(0,u.jsx)(g,{Show:this.state.ListViewing,OnHide:this.OnListClickEvent,UserList:this.state.jEmployeeList})]})}}const C=(0,S.$j)((e=>(console.log(e.loggedReducer),{data:e.loggedReducer})))(D)}}]);
//# sourceMappingURL=134.0bd814ee.chunk.js.map