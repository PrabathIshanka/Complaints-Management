(self.webpackChunkdatta_able_rv18_0_4=self.webpackChunkdatta_able_rv18_0_4||[]).push([[225],{72225:(t,e,a)=>{"use strict";a.r(e),a.d(e,{ReportSetup:()=>h,default:()=>c});var o=a(72791),s=a(50649),i=a.n(s),r=a(17451),l=a(24935),d=a.n(l),n=a(55294),p=a(85797),u=a(80184);class h extends o.Component{constructor(t){super(t),this.onUploadVisible=t=>!t.row.isEditing,this.onUploadClick=t=>{this.state.jLayoutUpdate?this.setState({jLayout:{},jLayoutUpdate:!1},(()=>{1===t&&n.Z.get("/api/report-layout-list",{params:{UserID:this.props.data.user.Id}}).then((t=>{this.setState({jLayoutList:JSON.parse(t.data[0].List)})})).catch((t=>{console.log(t)}))})):this.setState({jLayout:t.row.data},(()=>{let e=[...this.state.jParameterList];e=e.filter((e=>e.ReportID==t.row.data.AutoID)).map((t=>t)),this.setState({jParameter:e},(()=>{this.setState({jLayoutUpdate:!0})}))}))},this.OnToolbarPreparing=t=>{t.toolbarOptions.items.push({location:"after",widget:"dxButton",options:{icon:"add",onClick:t=>{this.setState({jLayoutUpdate:!this.state.jLayoutUpdate})}}})},this.onGradeMoveClick=(t,e)=>{let a=this.state.jlParameter.filter((e=>e.IndexNo!==t.row.rowIndex+1)),o=this.state.jlParameter.filter((e=>e.IndexNo===t.row.rowIndex+1));a.splice("Up"===e?0===t.row.rowIndex?0:t.row.rowIndex-1:t.row.rowIndex+1,0,o[0]),a.map(((t,e,o)=>{a[e].IndexNo=e+1})),this.setState({jlParameter:a})},this.state={jLayoutList:[],jlSchool:[],jlMainModule:[],jlSubModule:[],jlCategory:[],jlParameter:[],jLayout:{},jParameter:[],jParameterList:[],jLayoutUpdate:!1,DocReadOnly:!1},this.Status=[{ID:1,Name:"Yes"},{ID:0,Name:"No"}],this.LayoutRef=o.createRef()}componentDidMount(){Promise.all([n.Z.get("/api/school-lookup-byLoginUser",{params:{UserID:this.props.data.user.Id}}),n.Z.get("/api/module-main"),n.Z.get("/api/module-sub"),n.Z.get("/api/report-layout-list",{params:{UserID:this.props.data.user.Id}}),n.Z.get("/api/report-category-list"),n.Z.get("/api/report-parameter-lookup")]).then((t=>{let[e,a,o,s,i,r]=t;this.setState({jlSchool:e.data,jlMainModule:a.data,jlCategory:i.data,jLayoutList:JSON.parse(s.data[0].List),jlParameter:r.data,jParameterList:JSON.parse(s.data[0].ListParameter),DocReadOnly:false})})).catch((t=>console.log(t)))}onRowRemoved(t){n.Z.delete("/api/report/".concat(t.data.AutoID)).then((t=>{console.log(t.data)})).catch((t=>{console.log(t)})),n.Z.get("/api/file-delete",{params:{Folder:"layout",FileName:t.data.FileName}}).then((t=>{console.log(t.data)})).catch((t=>{console.log(t)}))}render(){return(0,u.jsxs)(o.Fragment,{children:[(0,u.jsx)(r.Z,{title:"Report Layout Setup",children:(0,u.jsxs)(i(),{id:"grid-layout",keyExpr:"AutoID",showBorders:!0,dataSource:this.state.jLayoutList,onToolbarPreparing:this.OnToolbarPreparing,onRowRemoved:this.onRowRemoved,children:[(0,u.jsx)(s.GroupPanel,{visible:!0}),(0,u.jsx)(s.SearchPanel,{visible:!0}),(0,u.jsx)(s.Grouping,{autoExpandAll:!0}),(0,u.jsx)(s.Paging,{defaultPageSize:100}),(0,u.jsx)(s.Editing,{mode:"popup",allowDeleting:!this.state.DocReadOnly,useIcons:!0,children:(0,u.jsx)(s.Popup,{title:"Layout",showTitle:!0})}),(0,u.jsx)(s.Column,{dataField:"CategoryID",caption:"Category",children:(0,u.jsx)(s.Lookup,{dataSource:this.state.jlCategory,displayExpr:"Name",valueExpr:"AutoID"})}),(0,u.jsx)(s.Column,{dataField:"Name"}),(0,u.jsx)(s.Column,{dataField:"Status",children:(0,u.jsx)(s.Lookup,{dataSource:this.Status,displayExpr:"Name",valueExpr:"ID"})}),(0,u.jsx)(s.Column,{type:"buttons",buttons:["edit",{hint:"Upload",icon:"upload",visible:this.onUploadVisible,onClick:this.onUploadClick},"delete"]})]})}),(0,u.jsx)(d(),{ref:this.LayoutRef,Show:this.state.jLayoutUpdate,OnHide:this.onUploadClick,FileInfo:this.state.jLayout,ParameterList:this.state.jParameter,MainModule:this.state.jlMainModule,SubModule:this.state.jlSubModule,School:this.state.jlSchool,Category:this.state.jlCategory,Parameter:this.state.jlParameter,onGradeMoveClick:this.onGradeMoveClick})]})}}const c=(0,p.$j)((t=>({data:t.loggedReducer})))(h)},24935:()=>{}}]);
//# sourceMappingURL=225.dbef0e13.chunk.js.map