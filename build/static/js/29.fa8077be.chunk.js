"use strict";(self.webpackChunkdatta_able_rv18_0_4=self.webpackChunkdatta_able_rv18_0_4||[]).push([[29],{22029:(e,t,i)=>{i.r(t),i.d(t,{Investigate:()=>L,default:()=>v});var a=i(72791),s=i(74387),n=i(17451),l=i(68962),o=i.n(l),d=i(89139),r=i(43360),h=i(21197),c=(i(67810),i(21830)),g=i.n(c),m=i(55294),p=i(65410),u=i.n(p),x=(i(51793),i(47885)),I=i(85797),j=i(8047),C=i.n(j),b=(i(97596),i(80184));class L extends a.Component{constructor(e){super(e),this.componentDidMount=e=>{m.Z.all([m.Z.get("http://20.201.121.161:4478/api/Branch",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),m.Z.get("http://20.201.121.161:4478/api/CrimeType",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),m.Z.get("http://20.201.121.161:4478/api/Employee",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}})]).then(m.Z.spread(((e,t,i)=>{this.setState({jBranch:e.data,jCrimeType:t.data,jEmployee:i.data},(()=>console.log("jRoles",this.state.jRoles)))}))).catch((e=>console.log(e)))},this.onLoadPanelHiding=(e,t)=>{this.setState({LoadPanelVisible:!1}),this.OnNotification(e,t)},this.OnNotification=(e,t)=>{u()({message:e,type:t,displayTime:3e3,position:{at:"top right",offset:"50"}})},this.OnClickEvent=()=>{},this.OnSaveValidation=async()=>!!this.FormLayout.validate().isValid||(this.OnNotification("Fields marked with * are required","error"),!1),this.SaveData=async e=>{await this.OnSaveValidation()&&g().fire({type:"info",showCancelButton:!0,text:"Do you want to complain ?",confirmButtonText:"Yes",cancelButtonText:"No",allowOutsideClick:!1,allowEscapeKey:!1}).then((e=>{e.value?(this.setState({LoadPanelVisible:!0}),console.log(this.state.base64ImageInvestigate),m.Z.all([m.Z.put("http://20.201.121.161:4478/api/InquiryResponse/Reply",{id:this.state.ComplainID,status:2,response:this.state.jComplain.investigatingResponse,attachment:this.state.base64ImageInvestigate},{headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"}})]).then(m.Z.spread((e=>{this.onLoadPanelHiding("Assign Success","success"),this.OnClearForm()}))).catch((e=>{this.onLoadPanelHiding("Something went wrong","error"),console.log(e)}))):"cancel"==e.dismiss||e.dismiss}))},this.OnClearForm=()=>{console.log(this.state.jComplain.image),this.setState({File:null,FileName:null,base64Image:null,base64ImageInvestigate:null,ComplainID:0,jComplain:{},jAuthorization:[],jComplainList:[],ListViewing:!1,DataLoading:!1,PasswordChange:!1,DocReadOnly:!1})},this.OnListClickEvent=e=>{this.setState({ListViewing:!this.state.ListViewing},(()=>{this.state.ListViewing&&(this.serverRequest=m.Z.get("http://20.201.121.161:4478/api/Inquiry",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((e=>{console.log(e.data),this.setState({jComplainList:e.data})})).catch((e=>{console.log(e)}))),this.state.ListViewing||0==e||(console.log("TEST SELECTED ID",e),this.setState({ComplainID:e},(()=>this.OnLoadData())))}))},this.onValueChanged=e=>{if(console.log(e),this.setState({File:e.value[0]}),this.state.File){const e=new FileReader;e.onloadend=()=>{this.setState({base64ImageInvestigate:e.result});const t=e.result;console.log(t)},e.readAsDataURL(this.state.File)}},this.state={File:null,FileName:null,base64Image:null,base64ImageInvestigate:null,ComplainID:0,jComplain:{Status:1},jCrimeType:[],jBranch:[],jEmployee:[],jAuthorization:[],jComplainList:[],SelectID:0,ListViewing:!1,DataLoading:!1,PasswordChange:!1,DocReadOnly:!1},this.Status=[{ID:0,Name:"Reviewing"},{ID:1,Name:"Assign To Officer"},{ID:2,Name:"Investigating"},{ID:3,Name:"Complete"},{ID:4,Name:"Closed"}],this.Institute=[{ID:0,Name:"Wildlife conservations"},{ID:1,Name:"Forest conservations"}],this.onLoadPanelHiding=this.onLoadPanelHiding.bind(this),this.FormRef=a.createRef()}get FormLayout(){return this.FormRef.current.instance}OnLoadData(){m.Z.all([m.Z.get("http://20.201.121.161:4478/api/Inquiry/"+this.state.ComplainID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}})]).then(m.Z.spread((e=>{console.log("HIIIII",e.data.userAttachment),this.setState({DataLoading:!0},(()=>this.setState({jComplain:e.data,base64Image:e.data.userAttachment,base64ImageInvestigate:e.data.investigatingAttachment},(()=>this.setState()))))}))).catch((e=>console.log(e)))}render(){return(0,b.jsxs)(s.Z,{children:[(0,b.jsx)(n.Z,{title:"Complain",children:(0,b.jsx)(o(),{ref:this.FormRef,formData:this.state.jComplain,children:(0,b.jsxs)(l.GroupItem,{caption:"Complain Information",colCount:2,children:[(0,b.jsxs)(l.Item,{dataField:"ticketId",editorOptions:{maxLength:4e3},disabled:!0,children:[(0,b.jsx)(l.RequiredRule,{message:"Field required"}),(0,b.jsx)(l.Label,{text:"Ticket"})]}),(0,b.jsx)(l.Item,{dataField:"crimeTypeId",editorType:"dxSelectBox",editorOptions:{items:this.state.jCrimeType,searchEnabled:!0,displayExpr:"name",valueExpr:"id"},disabled:!0,children:(0,b.jsx)(l.RequiredRule,{message:"Field required"})}),(0,b.jsx)(l.Item,{dataField:"branchId",editorType:"dxSelectBox",editorOptions:{items:this.state.jBranch,searchEnabled:!0,displayExpr:"name",valueExpr:"id"},disabled:!0,children:(0,b.jsx)(l.RequiredRule,{message:"Field required"})}),(0,b.jsx)(l.Item,{dataField:"institutionId",editorType:"dxSelectBox",editorOptions:{items:this.Institute,searchEnabled:!0,displayExpr:"Name",valueExpr:"ID"},disabled:!0,children:(0,b.jsx)(l.RequiredRule,{message:"Field required"})}),(0,b.jsxs)(l.Item,{dataField:"inquiryEntry",editorOptions:{maxLength:4e3},disabled:!0,children:[(0,b.jsx)(l.RequiredRule,{message:"Field required"}),(0,b.jsx)(l.Label,{text:"Inquiry"})]}),(0,b.jsx)(l.Item,{dataField:"status",editorType:"dxSelectBox",editorOptions:{items:this.Status,searchEnabled:!0,displayExpr:"Name",valueExpr:"ID"},disabled:!0,children:(0,b.jsx)(l.RequiredRule,{message:"Field required"})}),(0,b.jsx)(l.Item,{dataField:"employeeId",editorType:"dxSelectBox",editorOptions:{items:this.state.jEmployee,searchEnabled:!0,displayExpr:"firstName",valueExpr:"userId"},disabled:!0,children:(0,b.jsx)(l.RequiredRule,{message:"Field required"})}),(0,b.jsx)(l.Item,{dataField:"reviewingResponse",editorOptions:{maxLength:4e3},disabled:!0,children:(0,b.jsx)(l.Label,{text:"Reviewing Response"})}),(0,b.jsx)(l.Item,{dataField:"createdOn",editorType:"dxDateBox",disabled:!0,children:(0,b.jsx)(l.Label,{text:"Date"})}),(0,b.jsx)(l.Item,{dataField:"reviewingStartDate",editorType:"dxDateBox",disabled:!0,children:(0,b.jsx)(l.Label,{text:"reviewing Start Date"})}),(0,b.jsx)(l.Item,{dataField:"assignResponse",editorOptions:{maxLength:4e3},disabled:!0,children:(0,b.jsx)(l.Label,{text:"Assign Response"})}),(0,b.jsx)(l.Item,{dataField:"investigatingResponse",editorOptions:{maxLength:4e3},children:(0,b.jsx)(l.Label,{text:"Investigating Response"})}),(0,b.jsxs)(l.Item,{dataField:"completeResponse",editorOptions:{maxLength:4e3},visible:!1,children:[(0,b.jsx)(l.RequiredRule,{message:"Field required"}),(0,b.jsx)(l.Label,{text:"Complete Response"})]}),(0,b.jsx)(l.Item,{dataField:"userComment",editorOptions:{maxLength:4e3},visible:!1,children:(0,b.jsx)(l.Label,{text:"User Comment"})}),(0,b.jsxs)(l.Item,{disabled:0!=this.state.ComplainID,children:[(0,b.jsx)(C(),{selectButtonText:"Select File",labelText:"",accept:"application/x-rpt",allowedFileExtensions:[".jpg",".jpeg",".gif",".png"],uploadMode:"useForm",allowCanceling:!0,onValueChanged:this.onValueChanged}),(0,b.jsx)("img",{src:this.state.base64Image,alt:"",width:"200px",height:"200px"}),(0,b.jsx)(l.Label,{text:"User Attachment"})]}),(0,b.jsxs)(l.Item,{children:[(0,b.jsx)(C(),{selectButtonText:"Select File",labelText:"",accept:"application/x-rpt",allowedFileExtensions:[".jpg",".jpeg",".gif",".png"],uploadMode:"useForm",allowCanceling:!0,onValueChanged:this.onValueChanged}),(0,b.jsx)("img",{src:this.state.base64ImageInvestigate,alt:"",width:"200px",height:"200px"}),(0,b.jsx)(l.Label,{text:"Investigating Attachment"})]})]})})}),(0,b.jsxs)(d.Z,{bg:"light",variant:"light",children:[(0,b.jsx)(r.Z,{variant:"secondary",onClick:this.SaveData,disabled:0==this.state.ComplainID||!(1==this.state.jComplain.status),children:"Save"}),(0,b.jsx)(r.Z,{variant:"secondary",onClick:this.OnClearForm,children:"Clear"}),(0,b.jsx)(r.Z,{variant:"secondary",onClick:this.OnListClickEvent,children:"View List"})]}),(0,b.jsx)(x.LoadPanel,{message:"Processing.... Please, wait...",shadingColor:"rgba(0,0,0,0.4)",onHiding:this.onLoadPanelHiding,visible:this.state.LoadPanelVisible,showIndicator:!0,shading:!0,showPane:!0,closeOnOutsideClick:!1,width:500}),(0,b.jsx)(h.Z,{Show:this.state.ListViewing,OnHide:this.OnListClickEvent,ComplainInquiryList:this.state.jComplainList})]})}}const v=(0,I.$j)((e=>(console.log(e.loggedReducer),{data:e.loggedReducer})))(L)}}]);
//# sourceMappingURL=29.fa8077be.chunk.js.map