{"version":3,"file":"static/js/515.5b4bead4.chunk.js","mappings":"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","sources":["Forms/Admin/LayoutSetup.jsx"],"sourcesContent":["import React, { Component, Fragment } from \"react\";\r\nimport DataGrid, {\r\n  Column,\r\n  Editing,\r\n  Popup,\r\n  Lookup,\r\n  GroupPanel,\r\n  SearchPanel,\r\n  Grouping,\r\n  Paging,\r\n} from \"devextreme-react/data-grid\";\r\nimport Card from \"../../App/components/MainCard\";\r\nimport List from \"./LayoutUpload\";\r\nimport axios from \"axios\";\r\nimport { connect } from \"react-redux\";\r\n\r\nexport class LayoutSetup extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      jLayoutList: [],\r\n      jlSchool: [],\r\n      jlMainModule: [],\r\n      jlSubModule: [],\r\n\r\n      jLayout: {},\r\n      jLayoutUpdate: false,\r\n      DocReadOnly: false,\r\n    };\r\n\r\n    this.Status = [\r\n      { ID: 1, Name: \"Yes\" },\r\n      { ID: 0, Name: \"No\" },\r\n    ];\r\n\r\n    this.LayoutRef = React.createRef();\r\n  }\r\n\r\n  componentDidMount() {\r\n    let auth = false;\r\n\r\n    Promise.all([\r\n      axios.get(\"/api/school-lookup\"),\r\n      axios.get(\"/api/module-main\"),\r\n      axios.get(\"/api/module-sub\"),\r\n      axios.get(\"/api/layout-list\"),\r\n    ])\r\n      .then(([School, MainModule, SubModule, LayoutList]) => {\r\n        this.setState({\r\n          jlSchool: School.data,\r\n          jlMainModule: MainModule.data,\r\n          jlSubModule: SubModule.data,\r\n          jLayoutList: JSON.parse(LayoutList.data[0].List),\r\n          DocReadOnly: auth,\r\n        });\r\n      })\r\n      .catch((error) => console.log(error));\r\n  }\r\n\r\n  onUploadVisible = (e) => {\r\n    return !e.row.isEditing;\r\n  };\r\n\r\n  onUploadClick = (e) => {\r\n    if (!this.state.jLayoutUpdate) {\r\n      this.setState(\r\n        {\r\n          jLayout: e.row.data,\r\n        },\r\n        () => {\r\n          this.LayoutRef.current.onModuleValueChanged({\r\n            value: e.row.data.MainModule,\r\n          });\r\n          this.setState({ jLayoutUpdate: true });\r\n        }\r\n      );\r\n    } else {\r\n      this.setState({ jLayout: {}, jLayoutUpdate: false }, () => {\r\n        if (e === 1) {\r\n          axios\r\n            .get(\"/api/layout-list\")\r\n            .then((res) => {\r\n              this.setState({ jLayoutList: JSON.parse(res.data[0].List) });\r\n            })\r\n            .catch((error) => {\r\n              console.log(error);\r\n            });\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  OnToolbarPreparing = (e) => {\r\n    let toolbarItems = e.toolbarOptions.items;\r\n\r\n    toolbarItems.push({\r\n      location: \"after\",\r\n      widget: \"dxButton\",\r\n      options: {\r\n        icon: \"add\",\r\n        onClick: (e) => {\r\n          this.setState({ jLayoutUpdate: !this.state.jLayoutUpdate });\r\n        },\r\n      },\r\n    });\r\n  };\r\n\r\n  onRowRemoved(e) {\r\n    axios\r\n      .delete(`/api/layout/${e.data.AutoID}`)\r\n      .then((response) => {\r\n        console.log(response.data);\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n\r\n    axios\r\n      .get(\"/api/file-delete\", {\r\n        params: { Folder: \"layout\", FileName: e.data.FileName },\r\n      })\r\n      .then((res) => {\r\n        console.log(res.data);\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Fragment>\r\n        <Card title=\"Layout Setup\">\r\n          <DataGrid\r\n            id=\"grid-layout\"\r\n            keyExpr=\"AutoID\"\r\n            showBorders={true}\r\n            dataSource={this.state.jLayoutList}\r\n            onToolbarPreparing={this.OnToolbarPreparing}\r\n            onRowRemoved={this.onRowRemoved}\r\n          >\r\n            <GroupPanel visible={true} />\r\n            <SearchPanel visible={true} />\r\n            <Grouping autoExpandAll={true} />\r\n            <Paging defaultPageSize={100} />\r\n            <Editing\r\n              mode=\"popup\"\r\n              allowDeleting={!this.state.DocReadOnly}\r\n              useIcons={true}\r\n            >\r\n              <Popup title=\"Layout\" showTitle={true}></Popup>\r\n            </Editing>\r\n\r\n            <Column dataField=\"MainModule\" groupIndex={1}>\r\n              <Lookup\r\n                dataSource={this.state.jlMainModule}\r\n                displayExpr=\"Name\"\r\n                valueExpr=\"ModuleID\"\r\n              />\r\n            </Column>\r\n            <Column dataField=\"SubModule\">\r\n              <Lookup\r\n                dataSource={this.state.jlSubModule}\r\n                displayExpr=\"Name\"\r\n                valueExpr=\"ModuleID\"\r\n              />\r\n            </Column>\r\n            <Column dataField=\"Name\" />\r\n            <Column dataField=\"Status\">\r\n              <Lookup\r\n                dataSource={this.Status}\r\n                displayExpr=\"Name\"\r\n                valueExpr=\"ID\"\r\n              />\r\n            </Column>\r\n            <Column dataField=\"Remark\" />\r\n            <Column\r\n              type=\"buttons\"\r\n              buttons={[\r\n                \"edit\",\r\n                {\r\n                  hint: \"Upload\",\r\n                  icon: \"upload\",\r\n                  visible: this.onUploadVisible || this.state.DocReadOnly,\r\n                  onClick: this.onUploadClick,\r\n                },\r\n                \"delete\",\r\n              ]}\r\n            />\r\n          </DataGrid>\r\n        </Card>\r\n\r\n        <List\r\n          ref={this.LayoutRef}\r\n          Show={this.state.jLayoutUpdate}\r\n          OnHide={this.onUploadClick}\r\n          FileInfo={this.state.jLayout}\r\n          MainModule={this.state.jlMainModule}\r\n          SubModule={this.state.jlSubModule}\r\n          School={this.state.jlSchool}\r\n        ></List>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    data: state.loggedReducer,\r\n  };\r\n};\r\nexport default connect(mapStateToProps)(LayoutSetup);\r\n"],"names":["LayoutSetup","Component","constructor","props","super","onUploadVisible","e","row","isEditing","onUploadClick","this","state","jLayoutUpdate","setState","jLayout","axios","get","then","res","jLayoutList","JSON","parse","data","List","catch","error","console","log","LayoutRef","current","onModuleValueChanged","value","MainModule","OnToolbarPreparing","toolbarOptions","items","push","location","widget","options","icon","onClick","jlSchool","jlMainModule","jlSubModule","DocReadOnly","Status","ID","Name","React","componentDidMount","Promise","all","_ref","School","SubModule","LayoutList","onRowRemoved","delete","concat","AutoID","response","params","Folder","FileName","render","_jsxs","Fragment","children","_jsx","Card","title","DataGrid","id","keyExpr","showBorders","dataSource","onToolbarPreparing","GroupPanel","visible","SearchPanel","Grouping","autoExpandAll","Paging","defaultPageSize","Editing","mode","allowDeleting","useIcons","Popup","showTitle","Column","dataField","groupIndex","Lookup","displayExpr","valueExpr","type","buttons","hint","ref","Show","OnHide","FileInfo","connect","loggedReducer"],"sourceRoot":""}