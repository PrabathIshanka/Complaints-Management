"use strict";(self.webpackChunkdatta_able_rv18_0_4=self.webpackChunkdatta_able_rv18_0_4||[]).push([[598],{17451:(t,e,a)=>{a.d(e,{Z:()=>c});var i=a(72791),s=a(63370),o=a(64074),n=a(73193),r=(a(28088),a(74387)),l=a(91923),d=a(80184);class h extends i.Component{constructor(){super(...arguments),this.state={isOption:this.props.isOption,fullCard:!1,collapseCard:!1,loadCard:!1,cardRemove:!1},this.cardReloadHandler=()=>{this.setState({loadCard:!0}),setInterval((()=>{this.setState({loadCard:!1})}),3e3)},this.cardRemoveHandler=()=>{this.setState({cardRemove:!0})}}render(){let t,e,a,i,h="",c=[];return this.state.isOption&&(a=(0,d.jsx)("div",{className:"card-header-right",children:(0,d.jsxs)(s.Z,{alignRight:!0,className:"btn-group card-option",children:[(0,d.jsx)(s.Z.Toggle,{id:"dropdown-basic",className:"btn-icon",children:(0,d.jsx)("i",{className:"feather icon-more-horizontal"})}),(0,d.jsxs)(s.Z.Menu,{as:"ul",className:"list-unstyled card-option",children:[(0,d.jsxs)(s.Z.Item,{as:"li",className:"dropdown-item",onClick:()=>{this.setState((t=>({fullCard:!t.fullCard})))},children:[(0,d.jsx)("i",{className:this.state.fullCard?"feather icon-minimize":"feather icon-maximize"}),(0,d.jsxs)("a",{href:l.Z.BLANK_LINK,children:[" ",this.state.fullCard?"Restore":"Maximize"," "]})]}),(0,d.jsxs)(s.Z.Item,{as:"li",className:"dropdown-item",onClick:()=>{this.setState((t=>({collapseCard:!t.collapseCard})))},children:[(0,d.jsx)("i",{className:this.state.collapseCard?"feather icon-plus":"feather icon-minus"}),(0,d.jsxs)("a",{href:l.Z.BLANK_LINK,children:[" ",this.state.collapseCard?"Expand":"Collapse"," "]})]}),(0,d.jsxs)(s.Z.Item,{as:"li",className:"dropdown-item",onClick:this.cardReloadHandler,children:[(0,d.jsx)("i",{className:"feather icon-refresh-cw"}),(0,d.jsx)("a",{href:l.Z.BLANK_LINK,children:" Reload "})]}),(0,d.jsxs)(s.Z.Item,{as:"li",className:"dropdown-item",onClick:this.cardRemoveHandler,children:[(0,d.jsx)("i",{className:"feather icon-trash"}),(0,d.jsx)("a",{href:l.Z.BLANK_LINK,children:" Remove "})]})]})]})})),i=(0,d.jsxs)(o.Z.Header,{children:[(0,d.jsx)(o.Z.Title,{as:"h5",children:this.props.title}),a]}),this.state.fullCard&&(c=[...c,"full-card"],t={position:"fixed",top:0,left:0,right:0,width:this.props.windowWidth,height:this.props.windowHeight}),this.state.loadCard&&(c=[...c,"card-load"],e=(0,d.jsx)("div",{className:"card-loader",children:(0,d.jsx)("i",{className:"pct-loader1 anim-rotate"})})),this.state.cardRemove&&(c=[...c,"d-none"]),this.props.cardClass&&(c=[...c,this.props.cardClass]),h=(0,d.jsxs)(o.Z,{className:c.join(" "),style:t,children:[i,(0,d.jsx)(n.Z,{in:!this.state.collapseCard,children:(0,d.jsx)("div",{children:(0,d.jsx)(o.Z.Body,{children:this.props.children})})}),e]}),(0,d.jsx)(r.Z,{children:h})}}const c=h},42598:(t,e,a)=>{a.r(e),a.d(e,{UsersGroup:()=>N,default:()=>v});var i=a(72791),s=a(74387),o=a(17451),n=a(68962),r=a.n(n),l=a(89139),d=a(43360),h=a(45085),c=a(50649),u=a.n(c),p=a(80184);class m extends i.Component{constructor(t){super(t),this.onSelectionChanged=t=>{this.setState({SelectID:t.selectedRowsData[0].AutoID})},this.onSelectClick=t=>{this.props.OnHide(this.state.SelectID)},this.onCloseClick=t=>{this.props.OnHide(0)},this.state={SelectID:0,jList:[]}}componentDidMount(){}render(){return(0,p.jsx)(i.Fragment,{children:(0,p.jsxs)(h.Z,{size:"xl",show:this.props.Show,onHide:this.onCloseClick,backdrop:"static",keyboard:!1,children:[(0,p.jsx)(h.Z.Header,{closeButton:!0,children:(0,p.jsx)(h.Z.Title,{children:"List of User Group"})}),(0,p.jsxs)(h.Z.Body,{children:[(0,p.jsxs)(u(),{id:"grid-list",dataSource:this.props.List,keyExpr:"AutoID",showBorders:!0,wordWrapEnabled:!0,allowSearch:!0,selection:{mode:"single"},hoverStateEnabled:!0,onSelectionChanged:this.onSelectionChanged,children:[(0,p.jsx)(c.SearchPanel,{visible:!0}),(0,p.jsx)(c.GroupPanel,{visible:!0}),(0,p.jsx)(c.Paging,{defaultPageSize:20}),(0,p.jsx)(c.Column,{dataField:"AutoID",visible:!1}),(0,p.jsx)(c.Column,{dataField:"GroupCode"}),(0,p.jsx)(c.Column,{dataField:"GroupName"})]}),(0,p.jsx)("br",{}),(0,p.jsx)("br",{}),(0,p.jsx)(d.Z,{variant:"secondary",onClick:this.onSelectClick,children:"Open"}),(0,p.jsx)(d.Z,{variant:"secondary",onClick:this.onCloseClick,icon:"feather icon-layers",children:"Close"})]})]})})}}const x=m;var g=a(67810),j=a(21830),C=a.n(j),I=a(55294),D=a(65410),f=a.n(D),w=(a(51793),a(47885)),S=a(85797);class N extends i.Component{constructor(t){super(t),this.IDValidation=()=>new Promise(((t,e)=>{I.Z.get("/api/user-group-exist",{params:{AutoID:this.state.GroupID,Code:this.state.Group.GroupCode,Name:this.state.Group.GroupName}}).then((e=>{t(1===e.data[0].Exist)})).catch((t=>{console.log(t)}))})),this.OnSaveValidation=async()=>this.FormLayout.validate().isValid?!await this.IDValidation()||(this.OnNotification("Code or Name already exist","error"),!1):(this.OnNotification("Fields marked with * are required","error"),!1),this.onLoadPanelHiding=(t,e)=>{this.setState({LoadPanelVisible:!1}),this.OnNotification(t,e)},this.OnNotification=(t,e)=>{f()({message:t,type:e,displayTime:3e3,position:{at:"top right",offset:"50"}})},this.OnClickEvent=()=>{},this.SaveData=async()=>{await this.OnSaveValidation()&&C().fire({type:"info",showCancelButton:!0,text:"Do you want to save ?",confirmButtonText:"Yes",cancelButtonText:"No",allowOutsideClick:!1,allowEscapeKey:!1}).then((t=>{t.value?this.setState({LoadPanelVisible:!0},(()=>this.serverRequest=I.Z.post("/api/user-group",{GroupID:this.state.GroupID,UserGroup:JSON.stringify(this.state.Group),Authorization:JSON.stringify(this.state.Authorization)}).then((t=>{this.onLoadPanelHiding("Successfully Saved","success"),this.OnClearForm()})).catch((t=>{this.onLoadPanelHiding("Something went wrong","error"),console.log(t)})))):"cancel"==t.dismiss||t.dismiss}))},this.OnClearForm=()=>{let t=this.state.Authorization;t=t.map((t=>2!==t.Auth?{...t,Auth:2}:t)),this.setState({GroupID:0,Group:{Status:1},Authorization:t})},this.OnListClickEvent=t=>{this.setState({ListViewing:!this.state.ListViewing},(()=>{this.state.ListViewing&&(this.serverRequest=I.Z.get("/api/user-group-lookup").then((t=>{console.log(t.data),this.setState({jlGroupList:JSON.parse(t.data[0].List)})})).catch((t=>{console.log(t)}))),this.state.ListViewing||0==t||this.setState({GroupID:t},(()=>this.OnLoadData()))}))},this.onRowUpdating=t=>{9===t.newData.Auth&&(t.cancel=!0)},this.onRowUpdated=t=>{let e=this.state.Authorization;if(1===t.data.Type)e=e.map((e=>e.RootParent===t.data.MenuID||e.ParentID===t.data.MenuID?{...e,Auth:t.data.Auth}:e));else{let a=e.filter((e=>e.ParentID===t.data.ParentID)),i=e.filter((e=>e.ParentID===t.data.ParentID&&e.Auth===t.data.Auth));e=a.length===i.length?e.map((e=>e.MenuID===t.data.ParentID?{...e,Auth:t.data.Auth}:e)):e.map((e=>e.MenuID===t.data.ParentID?{...e,Auth:9}:e));let s=e.filter((e=>e.RootParent===t.data.RootParent)),o=e.filter((e=>e.RootParent===t.data.RootParent&&e.Auth===t.data.Auth));e=s.length===o.length?e.map((e=>e.MenuID===t.data.RootParent?{...e,Auth:t.data.Auth}:e)):e.map((e=>e.MenuID===t.data.RootParent?{...e,Auth:9}:e))}this.setState({Authorization:e})},this.state={GroupID:0,Group:{Status:1},Authorization:[],jlGroupList:[],ListViewing:!1,DocReadOnly:!1},this.Auth=[{ID:0,Name:"Full Authorization"},{ID:1,Name:"Read-Only"},{ID:2,Name:"No Authorization"},{ID:9,Name:"Various Authorization"}],this.Status=[{ID:1,Name:"Active"},{ID:0,Name:"Inactive"}],this.onLoadPanelHiding=this.onLoadPanelHiding.bind(this),this.SaveData=this.SaveData.bind(this),this.FormRef=i.createRef()}get FormLayout(){return this.FormRef.current.instance}componentDidMount(){I.Z.all([I.Z.get("/api/user-auth-tree")]).then(I.Z.spread((t=>{this.setState({Authorization:t.data,DocReadOnly:!1})}))).catch((t=>console.log(t)))}OnLoadData(){I.Z.all([I.Z.get("/api/user-group",{params:{GroupID:this.state.GroupID}})]).then(I.Z.spread((t=>{console.log("data view",t),this.setState({Group:JSON.parse(t.data[0].UserGroup),Authorization:JSON.parse(t.data[0].UserWiseAuthontication)})}))).catch((t=>console.log(t)))}render(){return(0,p.jsxs)(s.Z,{children:[(0,p.jsx)(o.Z,{title:"User",children:(0,p.jsx)(r(),{ref:this.FormRef,formData:this.state.Group,children:(0,p.jsxs)(n.GroupItem,{caption:"User Information",colCount:2,children:[(0,p.jsxs)(n.Item,{dataField:"GroupCode",editorOptions:{maxLength:50,readOnly:0!=this.state.GroupID},children:[(0,p.jsx)(n.RequiredRule,{message:"Field required"}),(0,p.jsx)(n.Label,{text:"Group Code"})]}),(0,p.jsx)(n.Item,{dataField:"GroupName",editorOptions:{maxLength:100},children:(0,p.jsx)(n.RequiredRule,{message:"Field required"})}),(0,p.jsx)(n.Item,{dataField:"Status",editorType:"dxSelectBox",editorOptions:{searchEnabled:!0,items:this.Status,displayExpr:"Name",valueExpr:"ID"},children:(0,p.jsx)(n.RequiredRule,{})})]})})}),(0,p.jsx)(o.Z,{title:"Authorization",children:(0,p.jsxs)(g.TreeList,{id:"user-authorization",dataSource:this.state.Authorization,columnAutoWidth:!0,wordWrapEnabled:!0,showBorders:!0,keyExpr:"MenuID",parentIdExpr:"ParentID",onRowUpdated:this.onRowUpdated,onRowUpdating:this.onRowUpdating,children:[(0,p.jsx)(g.Editing,{allowUpdating:!0,mode:"cell"}),(0,p.jsx)(g.Column,{minWidth:250,dataField:"Name",caption:"Module",allowEditing:!1,children:(0,p.jsx)(n.RequiredRule,{})}),(0,p.jsxs)(g.Column,{minWidth:120,dataField:"Auth",caption:"Authorization",children:[(0,p.jsx)(g.Lookup,{dataSource:this.Auth,valueExpr:"ID",displayExpr:"Name"}),(0,p.jsx)(n.RequiredRule,{})]})]})}),(0,p.jsxs)(l.Z,{bg:"light",variant:"light",children:[(0,p.jsx)(d.Z,{variant:"secondary",icon:"feather icon-layers",onClick:this.SaveData,disabled:this.state.DocReadOnly,children:"Save"}),(0,p.jsx)(d.Z,{variant:"secondary",icon:"feather icon-layers",onClick:this.OnClearForm,children:"Clear"}),(0,p.jsx)(d.Z,{variant:"secondary",icon:"feather icon-layers",onClick:this.OnListClickEvent,children:"View List"})]}),(0,p.jsx)(w.LoadPanel,{message:"Processing.... Please, wait...",shadingColor:"rgba(0,0,0,0.4)",onHiding:this.onLoadPanelHiding,visible:this.state.LoadPanelVisible,showIndicator:!0,shading:!0,showPane:!0,closeOnOutsideClick:!1,width:500}),(0,p.jsx)(x,{Show:this.state.ListViewing,OnHide:this.OnListClickEvent,List:this.state.jlGroupList})]})}}const v=(0,S.$j)((t=>(console.log(t.loggedReducer),{data:t.loggedReducer})))(N)}}]);
//# sourceMappingURL=598.4fe951aa.chunk.js.map